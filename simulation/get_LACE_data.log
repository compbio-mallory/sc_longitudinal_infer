module load R

# Script for test tun on LACE data
for i in ./default/*; do
	#simDataType=$(echo $i| cut -d'/' -f 3)
	for k in `seq 1 5`; do
		for j in ./default/rep$k/*D.csv; do
			python annotateSimData_LACE.py -input $j -output ./LACE_data/default/rep$k/ann_rep$k.csv
			Rscript LACE_data/convertCSVToRData.R ./LACE_data/default/rep$k/ann_rep$k.csv 100 500 ./LACE_data/default/rep$k/default_rep$k.RData
                done
        done
done

# Make the folders inside LACE_data/sim_input for each simulated variables before running the below scripts
for i in ./sim_input/*; do
        simDataType=$(echo $i| cut -d'/' -f 3)
        #echo $simDataType
        mkdir LACE_data/sim_input/$simDataType
        for k in `seq 1 5`; do
                mkdir LACE_data/sim_input/$simDataType/rep$k;
        done
done

# Run the following script to process all the simulated data scripts. We save LACE inputs inside LACE_data/sim_input
for i in sim_input/*; do
	simDataType=$(echo $i| cut -d'/' -f 2)
	for k in `seq 1 5`; do
		for j in sim_input/$simDataType/rep$k/*D.csv; do
			filename=$simDataType'_'rep$k
			python annotateSimData_LACE.py -input $j -output ./LACE_data/sim_input/$simDataType/rep$k/ann_rep$k.csv
			if [[ $simDataType == "t4" ]]; then
				Rscript LACE_data/convertCSVToRData.R ./LACE_data/sim_input/$simDataType/rep$k/ann_rep$k.csv 500 1000 1500 ./LACE_data/sim_input/$simDataType/rep$k/$filename.RData
			elif [[ $simDataType == "t5" ]]; then
				Rscript LACE_data/convertCSVToRData.R ./LACE_data/sim_input/$simDataType/rep$k/ann_rep$k.csv 200 500 1500 1800 ./LACE_data/sim_input/$simDataType/rep$k/$filename.RData
			else 
				Rscript LACE_data/convertCSVToRData.R ./LACE_data/sim_input/$simDataType/rep$k/ann_rep$k.csv 100 500 ./LACE_data/sim_input/$simDataType/rep$k/$filename.RData
			fi
		done
	done
done
		
