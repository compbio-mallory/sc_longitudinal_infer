# First get the processed Input file to run any clustering algorithm on the data
# Then run the other clustering algorithm on the data
# Then to get the input for the longitudinal tree we need to get the cells at each timepoints.

# We get that using tthe following script
#python SA501/getCellTimePoints.py 

# Get the consensus genotype from any clustering algorithm. Explain the format of the consensus genotype to use.
# Here we use the following script to get the consensus genotype from BnpC
#python gen_bnpc_getGmatrix.py -cc SA501_bnpc_output/m1/assignment.txt -gp SA501_bnpc_output/m1/genotypes_posterior_mean.tsv -celltp SA501/SA501.cell_timepoints.csv -doublet false -op SA501_bnpc_InGenotype/m1'.G'

# Then we run the following script to get the input for the longitudinal tree algorithm which is by stratifying the clusters across timepoints
# Please use the output from your clustering algorithm
python inputForTree.py -cc SA501_bnpc_output/m1/assignment.txt -cg SA501_bnpc_InGenotype/m1'.G.tsv' -sim false -celltp SA501/SA501.cell_timepoints.csv -op SA501_inputForTree/m1'.Gprime.csv' -ccop SA501_inputForTree/m1'.npy'

# Then run our algorithm to infer the tree given the clustering results
python longitudinalTree.py -input inputForTree/m1'.Gprime.csv' -cg bnpc_InGenotype/m1'.G.tsv' -cc inputForTree/m1'.npy' -D SA501/input.D.csv -celltp SA501/cell_timepoints.csv -sim false -op_tree inferredTree/m1'_tree.csv' -cloneNode inferredTree/m1'_cloneNode.npy' -cloneCells inferredTree/m1'_cloneCells.npy'

# Then select the tree with least no. of back and parallel mutations given the multiple runs
python selectBestClusterAndTree.py -tree inferredTree/'m1_tree.csv' inferredTree/'m2_tree.csv' inferredTree/'m3_tree.csv' inferredTree/'m4_tree.csv' inferredTree/'m5_tree.csv'
